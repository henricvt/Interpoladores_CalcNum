import numpy as np

n = int(input("Quantidade de pontos já obtidos: "))

x = float(input("Valor para interpolar: "))

X = np.zeros(n)

Y = np.zeros(n)

for i in range(0,n):
        
    X[i] = float(input(f"x[{i}]: "))
    
    Y[i] = float(input(f"y[{i}]: "))


#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
def calc_D(X,Y):
    
    D = np.zeros((n,n))
    
    D[:, 0] = Y
    
    for j in range(1,n,1):
        
        for i in range(j,n):
            
            D[i,j]= (D[i,j -1] - D[i -1,j -1]) / (X[i]-X[i-j])
    
    return D
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
def interp_newton(x,X,Y,D):
    
    prod = 1
    
    P = calc_D(X, Y)[0,0]
    
    for j in range(1,n,1):
        
        prod *= (x - X[j-1])
        
        for i in range(j,n):
            
            if i == j:
                
                P += D[i,j] * prod
                
    

    return P
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

D = calc_D(X, Y)

y_interp = interp_newton(x,X,Y,D)


print(f"\nA imagem correspondente ao valor interpolado é, aproximadamente: {y_interp:.5f}")







